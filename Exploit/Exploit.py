import os
from Modules.Weblogic import WebLogicRemoteCommandExecution
from Modules.Weblogic import WebLogicXMLDecoderDeserializationVulnerability
from ClassCongregation import AgentHeader

#可交互式漏洞利用很难受列表
ExploitModuleList={
"CVE-2019-2729":WebLogicRemoteCommandExecution.exploit,
"CVE-2017-10271":WebLogicXMLDecoderDeserializationVulnerability.exploit,
}
def main(**kwargs):
    Module=kwargs.get("Exploit")
    Url=kwargs.get("Url")
    RandomAgent=AgentHeader().result(kwargs.get("AgentHeader"))#获取随机头
    Proxies=kwargs.get("Proxies")
    Command=kwargs.get("Command")
    Sid = kwargs.get("Sid")
    Uid = kwargs.get("Uid")
    OperatingSystem=kwargs.get("OperatingSystem")
    if OperatingSystem!=("windows" or"linux"):
        print("\033[31m[ ! ] Please pass in the target operating system [windows/linux]\033[0m")
        os._exit(0)  # 直接退出整个函数
    try:
        ExploitModuleList[Module](Url, RandomAgent, Proxies,Command=Command,OperatingSystem=OperatingSystem,Sid=Sid,Uid=Uid)  # 调用列表里面的值

    except:  # 如果传入非法字符串会调用出错
        print("\033[31m[ ! ] Please enter the correct command to execute the module name\033[0m")
        os._exit(0)  # 直接退出整个函数
