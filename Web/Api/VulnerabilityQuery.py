from django.http import JsonResponse
from django.http import HttpResponse
from django.contrib.auth.decorators import login_required
from django.shortcuts import render, redirect
import hashlib
from Web.WebClassCongregation import UserInfo,ActiveScanList
import json



def ActiveScanListQuery(request):#主动扫描列表查询
    if request.method == "POST":
        try:
            UserToken=json.loads(request.body)["token"]
            UserName = UserInfo().QueryUserNameWithToken(UserToken)  # 如果登录成功后就来查询用户名
            if UserName!=None: # 查到了UID
                ActiveScanListQueryResult=ActiveScanList().Query(uid=UserName)
                if ActiveScanListQueryResult!=None:
                    return JsonResponse({'message':ActiveScanListQueryResult, 'code': 200, })
                else:
                    return JsonResponse({'message': '没找到数据', 'code': 404, })
        except:
            return JsonResponse({'message': 'Token不能为空', 'code': 500, })
    else:
        return JsonResponse({'message': '请使用Post请求', 'code': 500, })


